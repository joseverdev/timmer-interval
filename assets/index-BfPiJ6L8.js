(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const m of r.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&s(m)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();const H={$setsInput:document.getElementById("sets"),$worksSecondsInput:document.getElementById("work-input"),$workMinutesInput:document.getElementById("work-minutes-input"),$restMinutesInput:document.getElementById("rest-minutes-input"),$restSecondsInput:document.getElementById("rest-seconds-input"),$configDiv:document.querySelector(".config"),$preparationDiv:document.querySelector(".preparation"),$preparationText:document.getElementById("preparation__text"),$preparationTimmer:document.getElementById("preparation__timmer"),$countDiv:document.getElementById("count"),$countTitle:document.getElementById("count__title"),$countTimmer:document.getElementById("count__timmer"),$countSets:document.getElementById("count__sets"),$exitBtn:document.getElementById("exit"),$backBtn:document.getElementById("back")};class K{sounds={};baseUrl="/timmer-interval";constructor(){this.loadSounds()}loadSounds(){const e=n=>`${this.baseUrl}/sounds/${n}`.replace(/\/+/g,"/");this.sounds={beep:new Audio(e("beep.wav")),bell:new Audio(e("bell.wav")),interval:new Audio(e("interval.wav")),shoot:new Audio(e("shoot.wav"))},Object.values(this.sounds).forEach(n=>n.load())}play(e){const n=this.sounds[e];n&&(n.currentTime=0,n.play().catch(s=>console.error("Error al reproducir audio: ",s)))}}function a(t,e){const n=t.trim();if(n==="")return"00";const s=n.replace(/\D/g,"");if(s==="")return"00";let o=s.slice(0,e);return o.length===1&&(o=o.padStart(2,"0")),o}function w(t,e){t.addEventListener("input",()=>{t.value.length>e&&(t.value=t.value.slice(0,e))}),t.addEventListener("blur",()=>{t.value=a(t.value,e)})}function P(t,e,n){t.addEventListener("blur",()=>{let s=Number(t.value);isNaN(s)||s<e?t.value=a(String(e),2):s>n?t.value=a(String(n),2):t.value=a(String(s),2)})}function N(t,e){const n=Number(t.value),s=Number(e.value);n<59?t.value=a(String(n+1),2):s<99&&(e.value=a(String(s+1),2),t.value="00")}function M(t,e){const n=Number(t.value),s=Number(e.value);s>0?n===0?(e.value=a(String(s-1),2),t.value="59"):t.value=a(String(n-1),2):n>0&&(t.value=String(n-1).padStart(2,"0"))}const f=new K,{$setsInput:i,$workMinutesInput:b,$restMinutesInput:S,$restSecondsInput:p,$worksSecondsInput:h,$configDiv:T,$preparationDiv:D,$preparationText:O,$preparationTimmer:$,$countDiv:g,$countTitle:j,$countTimmer:_,$countSets:z,$exitBtn:c,$backBtn:x}=H;let l=null,u=!1,d=0,E="",y=null;i.addEventListener("keydown",t=>{["e","E","+","-","."].includes(t.key)&&t.preventDefault()});i.addEventListener("input",()=>{const t=i.value;t.length>2&&(i.value=t.slice(0,2))});w(b,2);w(S,2);w(h,2);w(p,2);P(h,0,59);P(p,0,59);document.addEventListener("click",t=>{const e=t.target;if(e.matches("#set-increment")){const s=Number(i.value);s<99&&(i.value=String(s+1))}if(e.matches("#set-decrement")){const s=Number(i.value);s>1&&(i.value=String(s-1))}if(e.matches("#work-increment")&&N(h,b),e.matches("#rest-increment")&&N(p,S),e.matches("#rest-decrement")&&M(p,S),e.matches("#work-decrement")&&M(h,b),e.matches("#start-btn")){let s=function(){if(D.classList.add("hidden"),g.classList.remove("hidden"),v>L){console.log("TIMER COMPLETADO"),x.classList.toggle("hidden"),c.classList.toggle("hidden"),f.play("bell");return}console.log(`Starting set ${v} of ${L}`),z.textContent=`${L-v+1}`,A(r,m,"Work",()=>{console.log("REST"),f.play("interval"),A(B,C,"Rest",()=>{f.play("interval"),console.log(`Set ${v} completed`),v++,s()})})},o=5;f.play("beep");const r=Number(b.value),m=Number(h.value),B=Number(S.value),C=Number(p.value),L=Number(i.value);console.log({workMinutes:r,workSeconds:m,restMinutes:B,restSeconds:C,sets:L}),T.classList.add("hidden"),D.classList.remove("hidden"),$.classList.remove("hidden"),$.textContent=String(o),O.classList.add("hidden");const U=setInterval(()=>{o>1?(f.play("beep"),console.log("Count:",o-1),$.textContent=String(o-1),o--):(f.play("shoot"),console.log("Go!"),$.classList.add("hidden"),O.classList.remove("hidden"),clearInterval(U),setTimeout(()=>{s()},1e3))},1e3);let v=1}const n=e.closest("#pause-btn");if(n){const[s,o]=n.querySelectorAll("svg");u=!u,s.classList.toggle("hidden"),o.classList.toggle("hidden"),u?g.style.opacity="0.6":g.style.opacity="1"}e.matches("#back")&&(console.log("BACK to the future"),l&&clearInterval(l),u=!1,d=0,E="",y=null,g.classList.add("hidden"),T.classList.remove("hidden"),document.body.classList.remove("state-work","state-rest"),x.classList.toggle("hidden"),c.classList.toggle("hidden"))});let q=null,k=!1;c.addEventListener("mousedown",()=>{k=!0,c.classList.add("is-active"),q=setTimeout(()=>{k&&(c.classList.remove("is-active"),l&&clearInterval(l),u=!1,d=0,E="",y=null,g.classList.add("hidden"),T.classList.remove("hidden"),document.body.classList.remove("state-work","state-rest"))},2e3)});function R(){k=!1,c.classList.remove("is-active"),clearTimeout(q)}c.addEventListener("mouseup",R);c.addEventListener("mouseleave",R);function I(t){const e=Math.floor(t/60),n=t%60;return`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`}function A(t,e,n,s){d=t*60+e,E=n,y=s,u=!1,j.textContent=n.toUpperCase(),document.body.classList.remove("state-work","state-rest"),n.toLowerCase()==="work"?document.body.classList.add("state-work"):n.toLowerCase()==="rest"&&document.body.classList.add("state-rest"),F()}function F(){l&&clearInterval(l),l=setInterval(()=>{u||(d>0?(console.log(`${E} Time: ${I(d)}`),_.textContent=I(d),d--):(_.textContent=I(0),clearInterval(l),y&&y()))},1e3)}
